# SSH Tunnel Manager

A terminal user interface (TUI) tool for creating, managing, and using SSH tunnels written in Go.

> **Important Notice**: This project's code is entirely generated by Artificial Intelligence (Claude AI), including core functionality implementation, user interface design, and documentation.

## Features

- 🚀 **Easy SSH Tunnel Management**: Create, start, stop, and delete SSH tunnels through an intuitive TUI
- 🔄 **Local and Remote Tunnels**: Support for both local port forwarding and remote port forwarding
- 💾 **Persistent Configuration**: Tunnel configurations are automatically saved and restored
- 📊 **Real-time Status**: Live status monitoring of tunnel connections
- 🎨 **Beautiful Interface**: Clean terminal UI with color coding and navigation

## Installation

Build from source:

```bash
go build -o ssh-tunnel-manager.exe .
```

## Usage

Run the application:

```bash
./ssh-tunnel-manager.exe
```

### Controls

#### Main View
- `↑/↓` or `k/j`: Navigate through tunnel list
- `Enter` or `Space`: View tunnel details
- `a`: Add new tunnel
- `e`: Edit selected tunnel
- `d`: Delete selected tunnel
- `s`: Start/Stop selected tunnel
- `q`: Quit application

#### Add/Edit View
- `↑/↓` or `k/j`: Navigate form fields
- Type to input text
- `Backspace`: Delete characters
- `Enter`: Save tunnel
- `Esc`: Cancel and return to main view

#### Detail View
- `s`: Start/Stop tunnel
- `q` or `Esc`: Return to main view

## Tunnel Types

### Local Tunnel (本地端口转发)
Forward local port to remote host through SSH server.

Example: Access a remote database
- **Local Port**: 3306
- **Remote Host**: database.internal
- **Remote Port**: 3306
- **SSH Host**: jump-server.example.com

Access via: `localhost:3306` → `database.internal:3306`

### Remote Tunnel (远程端口转发)
Forward remote port back to local host through SSH server.

Example: Expose local web server to remote network
- **Local Port**: 8080
- **Remote Host**: localhost
- **Remote Port**: 8080
- **SSH Host**: public-server.example.com

Remote access via: `public-server.example.com:8080` → `localhost:8080`

### Dynamic Tunnel (动态端口转发 - SOCKS5)
Create a SOCKS5 proxy server that forwards traffic through SSH server.

Example: Browse internet through remote server
- **Local Port**: 1080
- **SSH Host**: proxy-server.example.com

Configure browser to use SOCKS5 proxy: `localhost:1080`

## SSH Connection Parameters

When creating or editing tunnels, you can configure these SSH parameters:

### Basic Parameters
- **后台运行 (-f)**: Run SSH connection in background (true/false)
- **不执行远程命令 (-N)**: Don't execute remote commands, just forward ports (true/false)
- **允许远程连接 (-g)**: Allow remote hosts to connect to local forwarded ports (true/false)
- **启用压缩 (-C)**: Enable compression for better performance over slow connections (true/false)
- **安静模式 (-q)**: Suppress warning and diagnostic messages (true/false)

### Keep-Alive Parameters
- **保持连接活跃**: Enable SSH keep-alive mechanism (true/false)
- **服务器活跃间隔**: Interval in seconds to send keep-alive messages (default: 60)

### Parameter Recommendations

**For Database Access (Local Tunnel)**:
- No Command: `true` (recommended)
- Background: `false` (for easier monitoring)
- Compression: `true` (for better performance)
- Keep Alive: `true` with 60s interval

**For Web Service Exposure (Remote Tunnel)**:
- No Command: `true`
- Gateway Ports: `true` (to allow external connections)
- Background: `true` (for production use)
- Quiet: `true` (reduce log noise)

**For SOCKS5 Proxy (Dynamic Tunnel)**:
- No Command: `true`
- Compression: `true` (for web browsing)
- Keep Alive: `true` with 30s interval (for stability)
- Background: `false` (for monitoring traffic)

## Auto-Reconnect Feature

The SSH Tunnel Manager includes an advanced auto-reconnect feature that ensures tunnel stability and reliability.

### Configuration Options

When creating or editing tunnels, you can configure the following auto-reconnect parameters:

#### Basic Settings
- **启用自动重连**: Enable/disable automatic reconnection (true/false)
- **重连间隔**: Base interval in seconds between reconnection attempts (default: 10)
- **最大重连次数**: Maximum number of reconnection attempts (0 = unlimited, default: 0)
- **启用指数退避重连**: Enable exponential backoff for reconnection delays (true/false)

#### How It Works

1. **Connection Monitoring**: The system continuously monitors SSH connections using keep-alive messages
2. **Automatic Detection**: When a connection failure is detected, the auto-reconnect mechanism activates
3. **Intelligent Retry**: Reconnection attempts follow configurable intervals with optional exponential backoff
4. **Status Tracking**: The system tracks reconnection attempts and displays detailed status information

#### Exponential Backoff

When enabled, reconnection delays increase exponentially:
- 1st attempt: Base interval (e.g., 10 seconds)
- 2nd attempt: 2x base interval (20 seconds)
- 3rd attempt: 4x base interval (40 seconds)
- Maximum delay capped at 60 seconds

#### Recommended Settings

**For Critical Services (Database, API)**:
- Auto Reconnect: `true`
- Reconnect Interval: `5` seconds
- Max Attempts: `20` (to prevent infinite loops)
- Exponential Backoff: `true`

**For General Use (Web Browsing, File Transfer)**:
- Auto Reconnect: `true`
- Reconnect Interval: `10` seconds
- Max Attempts: `0` (unlimited)
- Exponential Backoff: `true`

**For Testing/Development**:
- Auto Reconnect: `false` (to see connection issues immediately)

### Monitoring Reconnections

The tunnel detail view displays comprehensive reconnection information:
- Current reconnection status
- Number of reconnection attempts
- Last reconnection timestamp
- Configured parameters

### Logging

When not in quiet mode (`-q`), the system logs:
- Connection loss detection
- Reconnection attempt notifications
- Success/failure status
- Backoff delay information

## Configuration

Tunnel configurations are stored in:
- **Windows**: `%USERPROFILE%\.ssh-tunnel-manager\tunnels.json`
- **Linux/macOS**: `~/.ssh-tunnel-manager/tunnels.json`

## SSH Authentication

The application supports SSH key-based authentication. Specify the path to your private key in the "SSH Key Path" field when creating a tunnel.

If no key path is provided, the application will attempt to use default SSH agent authentication.

## Example Tunnel Configuration

When adding a tunnel, you'll need to provide:

- **Name**: My Database Tunnel
- **Type**: local
- **Local Port**: 3306
- **Remote Host**: db.internal.company.com
- **Remote Port**: 3306
- **SSH Host**: bastion.company.com
- **SSH Port**: 22
- **SSH User**: username
- **SSH Key Path**: /home/user/.ssh/id_rsa (optional)
- **Description**: Database access tunnel (optional)

## Troubleshooting

### Connection Issues
- Verify SSH credentials and host accessibility
- Check if local/remote ports are already in use
- Ensure SSH key file permissions are correct (600)

### Permission Denied
- Verify SSH user has appropriate permissions
- Check SSH key file exists and is readable

### Port Already in Use
- Choose a different local port
- Stop conflicting services using the same port

## Development

### Dependencies
- [Bubble Tea](https://github.com/charmbracelet/bubbletea): TUI framework
- [Lip Gloss](https://github.com/charmbracelet/lipgloss): Styling library
- [Go SSH](https://golang.org/x/crypto/ssh): SSH client implementation

### Building
```bash
go mod download
go build -o ssh-tunnel-manager .
```

### Testing
```bash
go test ./...
```

## License

This project is open source. Feel free to use, modify, and distribute.

## AI Code Generation Statement

**Important**: All source code in this project was generated by Claude AI, an artificial intelligence assistant, including but not limited to:

- 🤖 **Core Functionality**: SSH tunnel management, auto-reconnection mechanisms
- 🎨 **User Interface**: TUI layout design, interaction logic
- 📝 **Documentation**: README files, code comments, usage instructions
- 🔧 **Configuration Management**: JSON config handling, parameter validation
- 🛡️ **Error Handling**: Exception handling, user notifications, reconnection strategies

### AI Technology Stack
- **AI Model**: Claude (Anthropic)
- **Generation Date**: 2024
- **Code Quality**: Production-grade with comprehensive error handling and UX optimization

This project demonstrates the powerful capabilities of AI in software development, from requirements analysis to code implementation and documentation, all completed independently by AI.

## Support and Documentation

For help with using SSH Tunnel Manager:
- Check the Chinese documentation: `README_CN.md`
- Report issues at the project repository
- Contribute improvements via pull requests

---

**Enjoy efficient SSH tunnel management!** 🚀